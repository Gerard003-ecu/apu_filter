================================================ test session starts =================================================
platform linux -- Python 3.10.19, pytest-8.4.2, pluggy-1.6.0 -- /home/gerardo/miniconda3/envs/ap_filter_env/bin/python
cachedir: .pytest_cache
rootdir: /home/gerardo/Documentos/GitHub/apu_filter
configfile: pyproject.toml
collected 544 items                                                                                                  

tests/test_app.py::TestSetupLogging::test_setup_logging_basic PASSED                                           [  0%]
tests/test_app.py::TestSetupLogging::test_setup_logging_creates_log_directory PASSED                           [  0%]
tests/test_app.py::TestSetupLogging::test_setup_logging_file_handler PASSED                                    [  0%]
tests/test_app.py::TestSetupLogging::test_setup_logging_console_handler PASSED                                 [  0%]
tests/test_app.py::TestSetupLogging::test_setup_logging_formatter PASSED                                       [  0%]
tests/test_app.py::TestFileValidator::test_validate_file_valid_csv PASSED                                      [  1%]
tests/test_app.py::TestFileValidator::test_validate_file_no_file PASSED                                        [  1%]
tests/test_app.py::TestFileValidator::test_validate_file_empty_filename PASSED                                 [  1%]
tests/test_app.py::TestFileValidator::test_validate_file_invalid_extension PASSED                              [  1%]
tests/test_app.py::TestFileValidator::test_validate_file_allowed_extensions PASSED                             [  1%]
tests/test_app.py::TestFileValidator::test_validate_file_too_large PASSED                                      [  2%]
tests/test_app.py::TestFileValidator::test_validate_file_secure_filename PASSED                                [  2%]
tests/test_app.py::TestAPUProcessor::test_process_apu_details_basic PASSED                                     [  2%]
tests/test_app.py::TestAPUProcessor::test_process_apu_details_empty_raises_error PASSED                        [  2%]
tests/test_app.py::TestAPUProcessor::test_process_apu_details_categories PASSED                                [  2%]
tests/test_app.py::TestAPUProcessor::test_group_by_category PASSED                                             [  2%]
tests/test_app.py::TestAPUProcessor::test_group_by_category_aggregation PASSED                                 [  3%]
tests/test_app.py::TestAPUProcessor::test_organize_breakdown PASSED                                            [  3%]
tests/test_app.py::TestAPUProcessor::test_process_apu_details_with_nan PASSED                                  [  3%]
tests/test_app.py::TestAPUProcessor::test_process_apu_details_with_alerts PASSED                               [  3%]
tests/test_app.py::TestDecorators::test_require_session_decorator_no_session PASSED                            [  3%]
tests/test_app.py::TestDecorators::test_require_session_decorator_expired_session PASSED                       [  4%]
tests/test_app.py::TestDecorators::test_require_session_decorator_valid_session PASSED                         [  4%]
tests/test_app.py::TestDecorators::test_handle_errors_decorator_value_error PASSED                             [  4%]
tests/test_app.py::TestDecorators::test_handle_errors_decorator_key_error PASSED                               [  4%]
tests/test_app.py::TestDecorators::test_handle_errors_decorator_generic_error PASSED                           [  4%]
tests/test_app.py::TestDecorators::test_handle_errors_decorator_success PASSED                                 [  4%]
tests/test_app.py::TestContextManagers::test_temporary_upload_directory_creates_dir PASSED                     [  5%]
tests/test_app.py::TestContextManagers::test_temporary_upload_directory_cleanup PASSED                         [  5%]
tests/test_app.py::TestContextManagers::test_temporary_upload_directory_cleanup_on_error PASSED                [  5%]
tests/test_app.py::TestContextManagers::test_temporary_upload_directory_multiple_files PASSED                  [  5%]
tests/test_app.py::TestEndpoints::test_index_endpoint PASSED                                                   [  5%]
tests/test_app.py::TestEndpoints::test_health_check_endpoint PASSED                                            [  6%]
tests/test_app.py::TestEndpoints::test_upload_missing_files PASSED                                             [  6%]
tests/test_app.py::TestEndpoints::test_upload_invalid_file PASSED                                              [  6%]
tests/test_app.py::TestEndpoints::test_upload_successful PASSED                                                [  6%]
tests/test_app.py::TestEndpoints::test_upload_processing_error PASSED                                          [  6%]
tests/test_app.py::TestEndpoints::test_get_apu_detail_no_session PASSED                                        [  6%]
tests/test_app.py::TestEndpoints::test_get_apu_detail_success PASSED                                           [  7%]
tests/test_app.py::TestEndpoints::test_get_apu_detail_not_found PASSED                                         [  7%]
tests/test_app.py::TestEndpoints::test_get_estimate_no_session PASSED                                          [  7%]
tests/test_app.py::TestEndpoints::test_get_estimate_invalid_content_type PASSED                                [  7%]
tests/test_app.py::TestEndpoints::test_get_estimate_no_params PASSED                                           [  7%]
tests/test_app.py::TestEndpoints::test_get_estimate_success PASSED                                             [  8%]
tests/test_app.py::TestErrorHandlers::test_404_handler PASSED                                                  [  8%]
tests/test_app.py::TestErrorHandlers::test_413_handler PASSED                                                  [  8%]
tests/test_app.py::TestErrorHandlers::test_500_handler PASSED                                                  [  8%]
tests/test_app.py::TestMiddleware::test_before_request_logging PASSED                                          [  8%]
tests/test_app.py::TestMiddleware::test_after_request_security_headers PASSED                                  [  9%]
tests/test_app.py::TestMiddleware::test_after_request_cors_disabled PASSED                                     [  9%]
tests/test_app.py::TestMiddleware::test_after_request_cors_enabled PASSED                                      [  9%]
tests/test_app.py::TestSemanticSearch::test_load_semantic_search_success PASSED                                [  9%]
tests/test_app.py::TestSemanticSearch::test_load_semantic_search_missing_files PASSED                          [  9%]
tests/test_app.py::TestSemanticSearch::test_load_semantic_search_error_handling PASSED                         [  9%]
tests/test_app.py::TestCreateApp::test_create_app_development PASSED                                           [ 10%]
tests/test_app.py::TestCreateApp::test_create_app_testing PASSED                                               [ 10%]
tests/test_app.py::TestCreateApp::test_create_app_production PASSED                                            [ 10%]
tests/test_app.py::TestCreateApp::test_create_app_config_loading PASSED                                        [ 10%]
tests/test_app.py::TestCreateApp::test_create_app_upload_folder_creation PASSED                                [ 10%]
tests/test_app.py::TestCreateApp::test_create_app_session_configuration PASSED                                 [ 11%]
tests/test_app.py::TestIntegration::test_full_workflow PASSED                                                  [ 11%]
tests/test_app.py::TestSecurity::test_sql_injection_attempt PASSED                                             [ 11%]
tests/test_app.py::TestSecurity::test_xss_attempt PASSED                                                       [ 11%]
tests/test_app.py::TestSecurity::test_path_traversal_attempt PASSED                                            [ 11%]
tests/test_app.py::TestConstants::test_session_timeout_constant PASSED                                         [ 11%]
tests/test_app.py::TestConstants::test_max_content_length_constant PASSED                                      [ 12%]
tests/test_app.py::TestConstants::test_allowed_extensions_constant PASSED                                      [ 12%]
tests/test_app.py::TestPerformance::test_health_check_response_time PASSED                                     [ 12%]
tests/test_app.py::TestPerformance::test_multiple_concurrent_requests PASSED                                   [ 12%]
tests/test_apu_processor.py::TestAPUProcessor::test_integration_with_calculate_unit_costs PASSED               [ 12%]
tests/test_apu_processor.py::TestAPUProcessor::test_process_all PASSED                                         [ 13%]
tests/test_data_loader.py::test_load_from_csv_success PASSED                                                   [ 13%]
tests/test_data_loader.py::test_load_from_csv_file_not_found PASSED                                            [ 13%]
tests/test_data_loader.py::test_load_from_csv_empty_error PASSED                                               [ 13%]
tests/test_data_loader.py::test_load_from_csv_encoding_error PASSED                                            [ 13%]
tests/test_data_loader.py::test_load_from_xlsx_single_sheet_success PASSED                                     [ 13%]
tests/test_data_loader.py::test_load_from_xlsx_all_sheets_success PASSED                                       [ 14%]
tests/test_data_loader.py::test_load_from_xlsx_file_not_found PASSED                                           [ 14%]
tests/test_data_loader.py::test_load_from_xlsx_sheet_not_found PASSED                                          [ 14%]
tests/test_data_loader.py::test_load_from_pdf_no_tables PASSED                                                 [ 14%]
tests/test_data_loader.py::test_load_from_pdf_with_dirty_tables PASSED                                         [ 14%]
tests/test_data_loader.py::test_load_from_pdf_with_table_settings PASSED                                       [ 15%]
tests/test_data_loader.py::test_load_from_pdf_file_not_found PASSED                                            [ 15%]
tests/test_data_loader.py::test_load_data_routes_to_csv PASSED                                                 [ 15%]
tests/test_data_loader.py::test_load_data_routes_to_xlsx PASSED                                                [ 15%]
tests/test_data_loader.py::test_load_data_routes_to_pdf PASSED                                                 [ 15%]
tests/test_data_loader.py::test_load_data_unsupported_format PASSED                                            [ 15%]
tests/test_data_loader.py::test_load_data_file_not_found PASSED                                                [ 16%]
tests/test_data_validator.py::TestDataValidator::test_validate_and_clean_data__inmutable_input PASSED          [ 16%]
tests/test_data_validator.py::TestDataValidator::test_validate_and_clean_data__integration_success PASSED      [ 16%]
tests/test_data_validator.py::TestDataValidator::test_validate_and_clean_data__invalid_data_store_type PASSED  [ 16%]
tests/test_data_validator.py::TestDataValidator::test_validate_and_clean_data__missing_apus_detail_key PASSED  [ 16%]
tests/test_data_validator.py::TestDataValidator::test_validate_and_clean_data__missing_presupuesto_key PASSED  [ 17%]
tests/test_data_validator.py::TestDataValidator::test_validate_and_clean_data__none_in_apus_detail PASSED      [ 17%]
tests/test_data_validator.py::TestDataValidator::test_validate_and_clean_data__none_in_presupuesto PASSED      [ 17%]
tests/test_data_validator.py::TestDataValidator::test_validate_extreme_costs__extreme_cost PASSED              [ 17%]
tests/test_data_validator.py::TestDataValidator::test_validate_extreme_costs__inmutable_input PASSED           [ 17%]
tests/test_data_validator.py::TestDataValidator::test_validate_extreme_costs__non_numeric_value PASSED         [ 18%]
tests/test_data_validator.py::TestDataValidator::test_validate_extreme_costs__normal_cost PASSED               [ 18%]
tests/test_data_validator.py::TestDataValidator::test_validate_missing_descriptions__fuzzy_matching_enabled PASSED [ 18%]
tests/test_data_validator.py::TestDataValidator::test_validate_missing_descriptions__inmutable_input PASSED    [ 18%]
tests/test_data_validator.py::TestDataValidator::test_validate_missing_descriptions__missing_description PASSED [ 18%]
tests/test_data_validator.py::TestDataValidator::test_validate_missing_descriptions__no_fuzzy_available PASSED [ 18%]
tests/test_data_validator.py::TestDataValidator::test_validate_missing_descriptions__present_description PASSED [ 19%]
tests/test_data_validator.py::TestDataValidator::test_validate_missing_descriptions__raw_insumos_df_missing_column PASSED [ 19%]
tests/test_data_validator.py::TestDataValidator::test_validate_missing_descriptions__raw_insumos_df_none PASSED [ 19%]
tests/test_data_validator.py::TestDataValidator::test_validate_zero_quantity_with_cost__inmutable_input PASSED [ 19%]
tests/test_data_validator.py::TestDataValidator::test_validate_zero_quantity_with_cost__invalid_types PASSED   [ 19%]
tests/test_data_validator.py::TestDataValidator::test_validate_zero_quantity_with_cost__non_recalculable PASSED [ 20%]
tests/test_data_validator.py::TestDataValidator::test_validate_zero_quantity_with_cost__recalculable PASSED    [ 20%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_initialization_valid_path PASSED                 [ 20%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_diagnose_file_not_found PASSED                   [ 20%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_diagnose_not_a_file PASSED                       [ 20%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_read_with_fallback_success_utf8 PASSED           [ 20%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_read_with_fallback_utf8_fails_latin1_succeeds PASSED [ 21%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_read_with_fallback_all_encodings_fail PASSED     [ 21%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_analyze_lines_correct_stats PASSED               [ 21%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_analyze_structure_block_detection PASSED         [ 21%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_detect_separator[a;b;c\nd;e;f-;] PASSED          [ 21%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_detect_separator[a,b,c\nd,e,f-,] PASSED          [ 22%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_detect_separator[a\tb\tc\nd\te\tf-\t] PASSED     [ 22%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_detect_separator[a|b|c\nd|e|f-|] PASSED          [ 22%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_detect_separator[a;b;c\na,b,c-;] PASSED          [ 22%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_detect_separator[a b c d-None] PASSED            [ 22%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_detect_separator[-None] PASSED                   [ 22%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_detect_patterns_item_and_unit PASSED             [ 23%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_diagnose_returns_expected_structure PASSED       [ 23%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_diagnose_multiple_calls_resets_state PASSED      [ 23%]
tests/test_diagnose_apus_file.py::TestAPUFileDiagnostic::test_generate_diagnostic_report_logs_output PASSED    [ 23%]
tests/test_estimator.py::test_find_best_semantic_match_success PASSED                                          [ 23%]
tests/test_estimator.py::test_find_best_semantic_match_below_threshold PASSED                                  [ 24%]
tests/test_estimator.py::test_find_best_semantic_match_empty_pool PASSED                                       [ 24%]
tests/test_estimator.py::test_find_best_semantic_match_empty_query PASSED                                      [ 24%]
tests/test_estimator.py::test_find_best_semantic_match_candidate_not_in_pool PASSED                            [ 24%]
tests/test_estimator.py::test_find_best_keyword_match_exact_word_success PASSED                                [ 24%]
tests/test_estimator.py::test_find_best_keyword_match_substring_success PASSED                                 [ 25%]
tests/test_estimator.py::test_find_best_keyword_match_no_match PASSED                                          [ 25%]
tests/test_estimator.py::test_calculate_estimate_delegates_correctly PASSED                                    [ 25%]
tests/test_generate_embeddings.py::TestDataValidator::test_validate_dataframe_success PASSED                   [ 25%]
tests/test_generate_embeddings.py::TestDataValidator::test_validate_dataframe_missing_columns PASSED           [ 25%]
tests/test_generate_embeddings.py::TestDataValidator::test_validate_dataframe_null_removal PASSED              [ 25%]
tests/test_generate_embeddings.py::TestDataValidator::test_validate_dataframe_duplicate_removal PASSED         [ 26%]
tests/test_generate_embeddings.py::TestDataValidator::test_validate_dataframe_text_length_filtering PASSED     [ 26%]
tests/test_generate_embeddings.py::TestDataValidator::test_validate_dataframe_empty_after_cleaning PASSED      [ 26%]
tests/test_generate_embeddings.py::TestMemoryMonitor::test_check_memory_sufficient PASSED                      [ 26%]
tests/test_generate_embeddings.py::TestMemoryMonitor::test_check_memory_exceeds_limit PASSED                   [ 26%]
tests/test_generate_embeddings.py::TestMemoryMonitor::test_check_memory_insufficient_available PASSED          [ 27%]
tests/test_generate_embeddings.py::TestFileManager::test_create_backup_existing_file PASSED                    [ 27%]
tests/test_generate_embeddings.py::TestFileManager::test_create_backup_nonexistent_file PASSED                 [ 27%]
tests/test_generate_embeddings.py::TestFileManager::test_load_data_json PASSED                                 [ 27%]
tests/test_generate_embeddings.py::TestFileManager::test_load_data_csv PASSED                                  [ 27%]
tests/test_generate_embeddings.py::TestFileManager::test_load_data_nonexistent_file PASSED                     [ 27%]
tests/test_generate_embeddings.py::TestFileManager::test_load_data_unsupported_format XFAIL (pd.read_json no
es thread-safe, problema conocido)                                                                             [ 28%]
tests/test_generate_embeddings.py::TestEmbeddingGenerator::test_load_model_success PASSED                      [ 28%]
tests/test_generate_embeddings.py::TestEmbeddingGenerator::test_load_model_failure PASSED                      [ 28%]
tests/test_generate_embeddings.py::TestEmbeddingGenerator::test_generate_embeddings_batch_simplified PASSED    [ 28%]
tests/test_generate_embeddings.py::TestEmbeddingGenerator::test_generate_embeddings_no_model PASSED            [ 28%]
tests/test_generate_embeddings.py::TestEmbeddingGenerator::test_build_faiss_index PASSED                       [ 29%]
tests/test_generate_embeddings.py::TestEmbeddingGenerator::test_validate_index_success_simplified PASSED       [ 29%]
tests/test_generate_embeddings.py::TestEmbeddingGenerator::test_validate_index_failure PASSED                  [ 29%]
tests/test_generate_embeddings.py::TestEmbeddingPipeline::test_run_complete_success_fixed PASSED               [ 29%]
tests/test_generate_embeddings.py::TestEmbeddingPipeline::test_run_with_invalid_input_file PASSED              [ 29%]
tests/test_generate_embeddings.py::TestEmbeddingPipeline::test_run_with_model_load_error PASSED                [ 29%]
tests/test_generate_embeddings.py::TestEmbeddingPipeline::test_run_with_empty_dataframe PASSED                 [ 30%]
tests/test_generate_embeddings.py::TestEmbeddingPipeline::test_run_with_backup_creation_fixed PASSED           [ 30%]
tests/test_generate_embeddings.py::TestPerformanceAndEdgeCases::test_large_dataset_handling[100] PASSED        [ 30%]
tests/test_generate_embeddings.py::TestPerformanceAndEdgeCases::test_large_dataset_handling[1000] PASSED       [ 30%]
tests/test_generate_embeddings.py::TestPerformanceAndEdgeCases::test_large_dataset_handling[5000] PASSED       [ 30%]
tests/test_generate_embeddings.py::TestPerformanceAndEdgeCases::test_special_characters_in_text PASSED         [ 31%]
tests/test_generate_embeddings.py::TestPerformanceAndEdgeCases::test_memory_estimation_accuracy PASSED         [ 31%]
tests/test_generate_embeddings.py::TestPerformanceAndEdgeCases::test_different_batch_sizes[1] PASSED           [ 31%]
tests/test_generate_embeddings.py::TestPerformanceAndEdgeCases::test_different_batch_sizes[10] PASSED          [ 31%]
tests/test_generate_embeddings.py::TestPerformanceAndEdgeCases::test_different_batch_sizes[100] PASSED         [ 31%]
tests/test_generate_embeddings.py::TestPerformanceAndEdgeCases::test_different_batch_sizes[512] PASSED         [ 31%]
tests/test_generate_embeddings.py::TestCLIIntegration::test_main_function_success PASSED                       [ 32%]
tests/test_generate_embeddings.py::TestCLIIntegration::test_main_function_with_error PASSED                    [ 32%]
tests/test_generate_embeddings.py::TestConcurrencyAndThreadSafety::test_concurrent_file_access XFAIL           [ 32%]
tests/test_models.py::TestProbabilityModels::test_sanitize_value_handles_nan PASSED                            [ 32%]
tests/test_models.py::TestProbabilityModels::test_sanitize_value_handles_non_numeric PASSED                    [ 32%]
tests/test_models.py::TestProbabilityModels::test_sanitize_value_handles_numeric_values PASSED                 [ 33%]
tests/test_models.py::TestProbabilityModels::test_simulation_handles_empty_input_list PASSED                   [ 33%]
tests/test_models.py::TestProbabilityModels::test_simulation_handles_invalid_input_types PASSED                [ 33%]
tests/test_models.py::TestProbabilityModels::test_simulation_handles_missing_required_columns PASSED           [ 33%]
tests/test_models.py::TestProbabilityModels::test_simulation_handles_mixed_data_types_and_nan PASSED           [ 33%]
tests/test_models.py::TestProbabilityModels::test_simulation_handles_zero_or_negative_cost PASSED              [ 34%]
tests/test_models.py::TestProbabilityModels::test_simulation_output_never_returns_numpy_nan PASSED             [ 34%]
tests/test_models.py::TestProbabilityModels::test_simulation_returns_correct_structure_with_valid_input PASSED [ 34%]
tests/test_models.py::TestProbabilityModels::test_simulation_throws_on_invalid_num_simulations PASSED          [ 34%]
tests/test_models.py::TestProbabilityModels::test_simulation_throws_on_negative_volatility PASSED              [ 34%]
tests/test_models.py::TestProbabilityModels::test_simulation_with_custom_volatility_factor PASSED              [ 34%]
tests/test_models.py::TestProbabilityModels::test_simulation_with_min_cost_threshold PASSED                    [ 35%]
tests/test_models.py::TestProbabilityModels::test_simulation_with_multiple_items PASSED                        [ 35%]
tests/test_models.py::TestProbabilityModels::test_simulation_with_valid_positive_costs PASSED                  [ 35%]
tests/test_procesador_csv.py::TestColumnNames::test_column_names_are_strings PASSED                            [ 35%]
tests/test_procesador_csv.py::TestColumnNames::test_no_duplicate_column_names PASSED                           [ 35%]
tests/test_procesador_csv.py::TestProcessingThresholds::test_custom_thresholds PASSED                          [ 36%]
tests/test_procesador_csv.py::TestProcessingThresholds::test_default_thresholds PASSED                         [ 36%]
tests/test_procesador_csv.py::TestDataValidator::test_detect_and_log_duplicates_no_duplicates PASSED           [ 36%]
tests/test_procesador_csv.py::TestDataValidator::test_detect_and_log_duplicates_with_duplicates PASSED         [ 36%]
tests/test_procesador_csv.py::TestDataValidator::test_validate_dataframe_none PASSED                           [ 36%]
tests/test_procesador_csv.py::TestDataValidator::test_validate_dataframe_not_empty_failure PASSED              [ 36%]
tests/test_procesador_csv.py::TestDataValidator::test_validate_dataframe_not_empty_success PASSED              [ 37%]
tests/test_procesador_csv.py::TestDataValidator::test_validate_numeric_range_failure PASSED                    [ 37%]
tests/test_procesador_csv.py::TestDataValidator::test_validate_numeric_range_success PASSED                    [ 37%]
tests/test_procesador_csv.py::TestDataValidator::test_validate_required_columns_failure PASSED                 [ 37%]
tests/test_procesador_csv.py::TestDataValidator::test_validate_required_columns_success PASSED                 [ 37%]
tests/test_procesador_csv.py::TestFileValidator::test_validate_file_exists_failure PASSED                      [ 38%]
tests/test_procesador_csv.py::TestFileValidator::test_validate_file_exists_success PASSED                      [ 38%]
tests/test_procesador_csv.py::TestFileValidator::test_validate_file_is_directory PASSED                        [ 38%]
tests/test_procesador_csv.py::TestPresupuestoProcessor::test_find_and_set_header_not_found PASSED              [ 38%]
tests/test_procesador_csv.py::TestPresupuestoProcessor::test_find_and_set_header_success PASSED                [ 38%]
tests/test_procesador_csv.py::TestPresupuestoProcessor::test_process_invalid_file PASSED                       [ 38%]
tests/test_procesador_csv.py::TestPresupuestoProcessor::test_process_success PASSED                            [ 39%]
tests/test_procesador_csv.py::TestPresupuestoProcessor::test_process_with_duplicates PASSED                    [ 39%]
tests/test_procesador_csv.py::TestInsumosProcessor::test_parse_file_structure PASSED                           [ 39%]
tests/test_procesador_csv.py::TestInsumosProcessor::test_process_success PASSED                                [ 39%]
tests/test_procesador_csv.py::TestInsumosProcessor::test_process_with_duplicates PASSED                        [ 39%]
tests/test_procesador_csv.py::TestAPUCostCalculator::test_calculate_complete_flow PASSED                       [ 40%]
tests/test_procesador_csv.py::TestAPUCostCalculator::test_classify_apus_instalacion PASSED                     [ 40%]
tests/test_procesador_csv.py::TestAPUCostCalculator::test_classify_apus_obra_completa PASSED                   [ 40%]
tests/test_procesador_csv.py::TestAPUCostCalculator::test_classify_apus_suministro PASSED                      [ 40%]
tests/test_procesador_csv.py::TestAPUCostCalculator::test_detect_cost_outliers PASSED                          [ 40%]
tests/test_procesador_csv.py::TestDataMerger::test_merge_apus_with_insumos_success PASSED                      [ 40%]
tests/test_procesador_csv.py::TestDataMerger::test_merge_apus_without_normalized_desc PASSED                   [ 41%]
tests/test_procesador_csv.py::TestDataMerger::test_merge_with_presupuesto_duplicates PASSED                    [ 41%]
tests/test_procesador_csv.py::TestDataMerger::test_merge_with_presupuesto_success PASSED                       [ 41%]
tests/test_procesador_csv.py::TestAuxiliaryFunctions::test_build_processed_apus_dataframe PASSED               [ 41%]
tests/test_procesador_csv.py::TestAuxiliaryFunctions::test_calculate_insumo_costs PASSED                       [ 41%]
tests/test_procesador_csv.py::TestAuxiliaryFunctions::test_calculate_total_costs PASSED                        [ 42%]
tests/test_procesador_csv.py::TestAuxiliaryFunctions::test_calculate_total_costs_exceeds_threshold PASSED      [ 42%]
tests/test_procesador_csv.py::TestAuxiliaryFunctions::test_group_and_split_description PASSED                  [ 42%]
tests/test_procesador_csv.py::TestAuxiliaryFunctions::test_synchronize_data_sources PASSED                     [ 42%]
tests/test_procesador_csv.py::TestProcessAllFilesIntegration::test_process_all_files_apu_load_failure_triggers_diagnostic PASSED [ 42%]
tests/test_procesador_csv.py::TestProcessAllFilesIntegration::test_process_all_files_custom_thresholds PASSED  [ 43%]
tests/test_procesador_csv.py::TestProcessAllFilesIntegration::test_process_all_files_empty_presupuesto PASSED  [ 43%]
tests/test_procesador_csv.py::TestProcessAllFilesIntegration::test_process_all_files_file_not_found PASSED     [ 43%]
tests/test_procesador_csv.py::TestProcessAllFilesIntegration::test_process_all_files_merge_error PASSED        [ 43%]
tests/test_procesador_csv.py::TestProcessAllFilesIntegration::test_process_all_files_success PASSED            [ 43%]
tests/test_procesador_csv.py::TestEdgeCases::test_empty_insumos_group PASSED                                   [ 43%]
tests/test_procesador_csv.py::TestEdgeCases::test_negative_costs PASSED                                        [ 44%]
tests/test_procesador_csv.py::TestEdgeCases::test_special_characters_in_descriptions PASSED                    [ 44%]
tests/test_procesador_csv.py::TestEdgeCases::test_very_long_descriptions PASSED                                [ 44%]
tests/test_procesador_csv.py::TestEdgeCases::test_zero_quantities PASSED                                       [ 44%]
tests/test_report_parser_crudo.py::TestParserConfig::test_default_config_creation PASSED                       [ 44%]
tests/test_report_parser_crudo.py::TestParserConfig::test_custom_config_creation PASSED                        [ 45%]
tests/test_report_parser_crudo.py::TestAPUContext::test_valid_apu_context_creation PASSED                      [ 45%]
tests/test_report_parser_crudo.py::TestAPUContext::test_apu_context_normalization PASSED                       [ 45%]
tests/test_report_parser_crudo.py::TestAPUContext::test_empty_apu_code_raises_error PASSED                     [ 45%]
tests/test_report_parser_crudo.py::TestAPUContext::test_is_valid_property PASSED                               [ 45%]
tests/test_report_parser_crudo.py::TestReportParserInitialization::test_valid_file_initialization PASSED       [ 45%]
tests/test_report_parser_crudo.py::TestReportParserInitialization::test_file_not_found_raises_error PASSED     [ 46%]
tests/test_report_parser_crudo.py::TestReportParserInitialization::test_directory_path_raises_error PASSED     [ 46%]
tests/test_report_parser_crudo.py::TestReportParserInitialization::test_empty_file_raises_error PASSED         [ 46%]
tests/test_report_parser_crudo.py::TestFileReading::test_read_utf8_file PASSED                                 [ 46%]
tests/test_report_parser_crudo.py::TestFileReading::test_read_latin1_file PASSED                               [ 46%]
tests/test_report_parser_crudo.py::TestFileReading::test_all_encodings_fail PASSED                             [ 47%]
tests/test_report_parser_crudo.py::TestCompleteParsing::test_parse_lines_format PASSED                         [ 47%]
tests/test_report_parser_crudo.py::TestCompleteParsing::test_parse_invalid_content PASSED                      [ 47%]
tests/test_report_parser_crudo.py::TestCompleteParsing::test_parse_already_parsed PASSED                       [ 47%]
tests/test_report_parser_crudo.py::TestEdgeCases::test_only_whitespace_file PASSED                             [ 47%]
tests/test_schemas.py::TestNormalizeUnit::test_normalize_unit_basic PASSED                                     [ 47%]
tests/test_schemas.py::TestNormalizeUnit::test_normalize_unit_case_insensitive PASSED                          [ 48%]
tests/test_schemas.py::TestNormalizeUnit::test_normalize_unit_with_spaces PASSED                               [ 48%]
tests/test_schemas.py::TestNormalizeUnit::test_normalize_unit_none PASSED                                      [ 48%]
tests/test_schemas.py::TestNormalizeUnit::test_normalize_unit_empty_string PASSED                              [ 48%]
tests/test_schemas.py::TestNormalizeUnit::test_normalize_unit_not_in_map PASSED                                [ 48%]
tests/test_schemas.py::TestNormalizeUnit::test_normalize_unit_time_units PASSED                                [ 49%]
tests/test_schemas.py::TestNormalizeUnit::test_normalize_unit_mass_units PASSED                                [ 49%]
tests/test_schemas.py::TestNormalizeUnit::test_normalize_unit_volume_units PASSED                              [ 49%]
tests/test_schemas.py::TestNormalizeUnit::test_normalize_unit_area_units PASSED                                [ 49%]
tests/test_schemas.py::TestNormalizeUnit::test_normalize_unit_transport_units PASSED                           [ 49%]
tests/test_schemas.py::TestNormalizeUnit::test_normalize_unit_cache PASSED                                     [ 50%]
tests/test_schemas.py::TestNormalizeUnit::test_normalize_unit_invalid_type PASSED                              [ 50%]
tests/test_schemas.py::TestNormalizeDescription::test_normalize_description_basic PASSED                       [ 50%]
tests/test_schemas.py::TestNormalizeDescription::test_normalize_description_accents PASSED                     [ 50%]
tests/test_schemas.py::TestNormalizeDescription::test_normalize_description_multiple_spaces PASSED             [ 50%]
tests/test_schemas.py::TestNormalizeDescription::test_normalize_description_special_chars PASSED               [ 50%]
tests/test_schemas.py::TestNormalizeDescription::test_normalize_description_leading_trailing_spaces PASSED     [ 51%]
tests/test_schemas.py::TestNormalizeDescription::test_normalize_description_none PASSED                        [ 51%]
tests/test_schemas.py::TestNormalizeDescription::test_normalize_description_empty_string PASSED                [ 51%]
tests/test_schemas.py::TestNormalizeDescription::test_normalize_description_numbers PASSED                     [ 51%]
tests/test_schemas.py::TestNormalizeDescription::test_normalize_description_parentheses PASSED                 [ 51%]
tests/test_schemas.py::TestNormalizeDescription::test_normalize_description_cache PASSED                       [ 52%]
tests/test_schemas.py::TestNormalizeDescription::test_normalize_description_invalid_type PASSED                [ 52%]
tests/test_schemas.py::TestNormalizeCodigo::test_normalize_codigo_basic PASSED                                 [ 52%]
tests/test_schemas.py::TestNormalizeCodigo::test_normalize_codigo_uppercase PASSED                             [ 52%]
tests/test_schemas.py::TestNormalizeCodigo::test_normalize_codigo_with_spaces PASSED                           [ 52%]
tests/test_schemas.py::TestNormalizeCodigo::test_normalize_codigo_special_chars PASSED                         [ 52%]
tests/test_schemas.py::TestNormalizeCodigo::test_normalize_codigo_preserve_valid_chars PASSED                  [ 53%]
tests/test_schemas.py::TestNormalizeCodigo::test_normalize_codigo_none_raises_error PASSED                     [ 53%]
tests/test_schemas.py::TestNormalizeCodigo::test_normalize_codigo_empty_raises_error PASSED                    [ 53%]
tests/test_schemas.py::TestNormalizeCodigo::test_normalize_codigo_too_long_raises_error PASSED                 [ 53%]
tests/test_schemas.py::TestNormalizeCodigo::test_normalize_codigo_cache PASSED                                 [ 53%]
tests/test_schemas.py::TestNumericValidator::test_validate_non_negative_valid_int PASSED                       [ 54%]
tests/test_schemas.py::TestNumericValidator::test_validate_non_negative_valid_float PASSED                     [ 54%]
tests/test_schemas.py::TestNumericValidator::test_validate_non_negative_decimal PASSED                         [ 54%]
tests/test_schemas.py::TestNumericValidator::test_validate_non_negative_zero PASSED                            [ 54%]
tests/test_schemas.py::TestNumericValidator::test_validate_non_negative_negative_raises_error PASSED           [ 54%]
tests/test_schemas.py::TestNumericValidator::test_validate_non_negative_with_min_value PASSED                  [ 54%]
tests/test_schemas.py::TestNumericValidator::test_validate_non_negative_with_max_value PASSED                  [ 55%]
tests/test_schemas.py::TestNumericValidator::test_validate_non_negative_with_range PASSED                      [ 55%]
tests/test_schemas.py::TestNumericValidator::test_validate_non_negative_invalid_type PASSED                    [ 55%]
tests/test_schemas.py::TestNumericValidator::test_validate_non_negative_nan_raises_error PASSED                [ 55%]
tests/test_schemas.py::TestNumericValidator::test_validate_non_negative_inf_raises_error PASSED                [ 55%]
tests/test_schemas.py::TestNumericValidator::test_validate_positive_valid PASSED                               [ 56%]
tests/test_schemas.py::TestNumericValidator::test_validate_positive_zero_raises_error PASSED                   [ 56%]
tests/test_schemas.py::TestNumericValidator::test_validate_positive_negative_raises_error PASSED               [ 56%]
tests/test_schemas.py::TestStringValidator::test_validate_non_empty_valid PASSED                               [ 56%]
tests/test_schemas.py::TestStringValidator::test_validate_non_empty_with_spaces PASSED                         [ 56%]
tests/test_schemas.py::TestStringValidator::test_validate_non_empty_empty_raises_error PASSED                  [ 56%]
tests/test_schemas.py::TestStringValidator::test_validate_non_empty_whitespace_raises_error PASSED             [ 57%]
tests/test_schemas.py::TestStringValidator::test_validate_non_empty_invalid_type_raises_error PASSED           [ 57%]
tests/test_schemas.py::TestStringValidator::test_validate_non_empty_with_max_length PASSED                     [ 57%]
tests/test_schemas.py::TestStringValidator::test_validate_non_empty_none_raises_error PASSED                   [ 57%]
tests/test_schemas.py::TestTipoInsumo::test_tipo_insumo_values PASSED                                          [ 57%]
tests/test_schemas.py::TestTipoInsumo::test_from_string_valid PASSED                                           [ 58%]
tests/test_schemas.py::TestTipoInsumo::test_from_string_with_spaces PASSED                                     [ 58%]
tests/test_schemas.py::TestTipoInsumo::test_from_string_already_enum PASSED                                    [ 58%]
tests/test_schemas.py::TestTipoInsumo::test_from_string_invalid_raises_error PASSED                            [ 58%]
tests/test_schemas.py::TestTipoInsumo::test_get_valid_values PASSED                                            [ 58%]
tests/test_schemas.py::TestInsumoProcesado::test_create_valid_insumo PASSED                                    [ 59%]
tests/test_schemas.py::TestInsumoProcesado::test_normalization_in_post_init PASSED                             [ 59%]
tests/test_schemas.py::TestInsumoProcesado::test_description_normalization PASSED                              [ 59%]
tests/test_schemas.py::TestInsumoProcesado::test_tipo_categoria_sync PASSED                                    [ 59%]
tests/test_schemas.py::TestInsumoProcesado::test_empty_codigo_raises_error PASSED                              [ 59%]
tests/test_schemas.py::TestInsumoProcesado::test_empty_descripcion_raises_error PASSED                         [ 59%]
tests/test_schemas.py::TestInsumoProcesado::test_negative_cantidad_raises_error PASSED                         [ 60%]
tests/test_schemas.py::TestInsumoProcesado::test_negative_precio_raises_error PASSED                           [ 60%]
tests/test_schemas.py::TestInsumoProcesado::test_valor_total_consistency_warning PASSED                        [ 60%]
tests/test_schemas.py::TestInsumoProcesado::test_to_dict PASSED                                                [ 60%]
tests/test_schemas.py::TestInsumoProcesado::test_validate_method PASSED                                        [ 60%]
tests/test_schemas.py::TestInsumoProcesado::test_repr PASSED                                                   [ 61%]
tests/test_schemas.py::TestManoDeObra::test_create_valid_mano_obra PASSED                                      [ 61%]
tests/test_schemas.py::TestManoDeObra::test_rendimiento_required PASSED                                        [ 61%]
tests/test_schemas.py::TestManoDeObra::test_rendimiento_cantidad_consistency PASSED                            [ 61%]
tests/test_schemas.py::TestManoDeObra::test_expected_units_warning PASSED                                      [ 61%]
tests/test_schemas.py::TestManoDeObra::test_jornal_validation PASSED                                           [ 61%]
tests/test_schemas.py::TestManoDeObra::test_jornal_negative_raises_error PASSED                                [ 62%]
tests/test_schemas.py::TestEquipo::test_create_valid_equipo PASSED                                             [ 62%]
tests/test_schemas.py::TestEquipo::test_rendimiento_should_be_zero PASSED                                      [ 62%]
tests/test_schemas.py::TestEquipo::test_expected_time_units PASSED                                             [ 62%]
tests/test_schemas.py::TestSuministro::test_create_valid_suministro PASSED                                     [ 62%]
tests/test_schemas.py::TestSuministro::test_cantidad_zero_warning PASSED                                       [ 63%]
tests/test_schemas.py::TestSuministro::test_rendimiento_should_be_zero PASSED                                  [ 63%]
tests/test_schemas.py::TestSuministro::test_expected_units PASSED                                              [ 63%]
tests/test_schemas.py::TestTransporte::test_create_valid_transporte PASSED                                     [ 63%]
tests/test_schemas.py::TestTransporte::test_expected_transport_units PASSED                                    [ 63%]
tests/test_schemas.py::TestTransporte::test_rendimiento_should_be_zero PASSED                                  [ 63%]
tests/test_schemas.py::TestOtro::test_create_valid_otro PASSED                                                 [ 64%]
tests/test_schemas.py::TestOtro::test_flexible_units PASSED                                                    [ 64%]
tests/test_schemas.py::TestCreateInsumo::test_create_mano_obra PASSED                                          [ 64%]
tests/test_schemas.py::TestCreateInsumo::test_create_equipo PASSED                                             [ 64%]
tests/test_schemas.py::TestCreateInsumo::test_create_suministro PASSED                                         [ 64%]
tests/test_schemas.py::TestCreateInsumo::test_create_transporte PASSED                                         [ 65%]
tests/test_schemas.py::TestCreateInsumo::test_create_otro PASSED                                               [ 65%]
tests/test_schemas.py::TestCreateInsumo::test_create_with_enum PASSED                                          [ 65%]
tests/test_schemas.py::TestCreateInsumo::test_create_case_insensitive PASSED                                   [ 65%]
tests/test_schemas.py::TestCreateInsumo::test_create_invalid_tipo_raises_error PASSED                          [ 65%]
tests/test_schemas.py::TestCreateInsumo::test_create_missing_kwargs_raises_error PASSED                        [ 65%]
tests/test_schemas.py::TestCreateInsumo::test_create_forces_tipo_sync PASSED                                   [ 66%]
tests/test_schemas.py::TestValidateInsumoData::test_validate_complete_data PASSED                              [ 66%]
tests/test_schemas.py::TestValidateInsumoData::test_validate_adds_defaults PASSED                              [ 66%]
tests/test_schemas.py::TestValidateInsumoData::test_validate_converts_numeric_strings PASSED                   [ 66%]
tests/test_schemas.py::TestValidateInsumoData::test_validate_missing_required_raises_error PASSED              [ 66%]
tests/test_schemas.py::TestValidateInsumoData::test_validate_null_required_raises_error PASSED                 [ 67%]
tests/test_schemas.py::TestValidateInsumoData::test_validate_invalid_numeric_raises_error PASSED               [ 67%]
tests/test_schemas.py::TestValidateInsumoData::test_validate_normalizes_tipo PASSED                            [ 67%]
tests/test_schemas.py::TestValidateInsumoData::test_validate_calculates_valor_total PASSED                     [ 67%]
tests/test_schemas.py::TestValidateInsumoData::test_validate_not_dict_raises_error PASSED                      [ 67%]
tests/test_schemas.py::TestCreateInsumoFromRaw::test_create_from_raw_success PASSED                            [ 68%]
tests/test_schemas.py::TestCreateInsumoFromRaw::test_create_from_raw_invalid_data PASSED                       [ 68%]
tests/test_schemas.py::TestUtilityFunctions::test_get_tipo_insumo_class_valid PASSED                           [ 68%]
tests/test_schemas.py::TestUtilityFunctions::test_get_tipo_insumo_class_with_enum PASSED                       [ 68%]
tests/test_schemas.py::TestUtilityFunctions::test_get_tipo_insumo_class_invalid_raises_error PASSED            [ 68%]
tests/test_schemas.py::TestUtilityFunctions::test_get_all_tipo_insumo_values PASSED                            [ 68%]
tests/test_schemas.py::TestUtilityFunctions::test_is_valid_tipo_insumo_valid PASSED                            [ 69%]
tests/test_schemas.py::TestUtilityFunctions::test_is_valid_tipo_insumo_invalid PASSED                          [ 69%]
tests/test_schemas.py::TestConstants::test_unidad_normalizada_map_exists PASSED                                [ 69%]
tests/test_schemas.py::TestConstants::test_insumo_class_map_complete PASSED                                    [ 69%]
tests/test_schemas.py::TestConstants::test_tolerance_values PASSED                                             [ 69%]
tests/test_schemas.py::TestConstants::test_length_limits PASSED                                                [ 70%]
tests/test_schemas.py::TestConstants::test_numeric_limits PASSED                                               [ 70%]
tests/test_schemas.py::TestConstants::test_unit_sets PASSED                                                    [ 70%]
tests/test_schemas.py::TestIntegration::test_full_workflow_create_validate_serialize PASSED                    [ 70%]
tests/test_schemas.py::TestIntegration::test_workflow_all_types PASSED                                         [ 70%]
tests/test_schemas.py::TestEdgeCases::test_very_large_values PASSED                                            [ 70%]
tests/test_schemas.py::TestEdgeCases::test_very_small_values PASSED                                            [ 71%]
tests/test_schemas.py::TestEdgeCases::test_zero_values PASSED                                                  [ 71%]
tests/test_schemas.py::TestEdgeCases::test_unicode_characters PASSED                                           [ 71%]
tests/test_schemas.py::TestEdgeCases::test_very_long_description PASSED                                        [ 71%]
tests/test_schemas.py::TestEdgeCases::test_decimal_precision PASSED                                            [ 71%]
tests/test_utils.py::TestNormalizeText::test_normalize_simple_text PASSED                                      [ 72%]
tests/test_utils.py::TestNormalizeText::test_normalize_accents PASSED                                          [ 72%]
tests/test_utils.py::TestNormalizeText::test_normalize_special_chars_default PASSED                            [ 72%]
tests/test_utils.py::TestNormalizeText::test_normalize_preserve_special_chars PASSED                           [ 72%]
tests/test_utils.py::TestNormalizeText::test_normalize_multiple_spaces PASSED                                  [ 72%]
tests/test_utils.py::TestNormalizeText::test_normalize_empty_string PASSED                                     [ 72%]
tests/test_utils.py::TestNormalizeText::test_normalize_none_raises_type_error PASSED                           [ 73%]
tests/test_utils.py::TestNormalizeText::test_normalize_numeric_input PASSED                                    [ 73%]
tests/test_utils.py::TestNormalizeText::test_normalize_case_insensitive PASSED                                 [ 73%]
tests/test_utils.py::TestNormalizeText::test_normalize_cache_hit PASSED                                        [ 73%]
tests/test_utils.py::TestNormalizeTextSeries::test_normalize_series_basic PASSED                               [ 73%]
tests/test_utils.py::TestNormalizeTextSeries::test_normalize_series_empty PASSED                               [ 74%]
tests/test_utils.py::TestNormalizeTextSeries::test_normalize_series_none_input PASSED                          [ 74%]
tests/test_utils.py::TestNormalizeTextSeries::test_normalize_series_with_nulls PASSED                          [ 74%]
tests/test_utils.py::TestNormalizeTextSeries::test_normalize_series_large_chunks PASSED                        [ 74%]
tests/test_utils.py::TestNormalizeTextSeries::test_normalize_series_preserve_special PASSED                    [ 74%]
tests/test_utils.py::TestParseNumber::test_parse_integer_string PASSED                                         [ 75%]
tests/test_utils.py::TestParseNumber::test_parse_float_string PASSED                                           [ 75%]
tests/test_utils.py::TestParseNumber::test_parse_float_comma_separator PASSED                                  [ 75%]
tests/test_utils.py::TestParseNumber::test_parse_direct_numeric PASSED                                         [ 75%]
tests/test_utils.py::TestParseNumber::test_parse_none_returns_default PASSED                                   [ 75%]
tests/test_utils.py::TestParseNumber::test_parse_thousands_comma_separator PASSED                              [ 75%]
tests/test_utils.py::TestParseNumber::test_parse_thousands_dot_separator PASSED                                [ 76%]
tests/test_utils.py::TestParseNumber::test_parse_thousands_space_separator PASSED                              [ 76%]
tests/test_utils.py::TestParseNumber::test_parse_percentage PASSED                                             [ 76%]
tests/test_utils.py::TestParseNumber::test_parse_percentage_disabled PASSED                                    [ 76%]
tests/test_utils.py::TestParseNumber::test_parse_scientific_notation PASSED                                    [ 76%]
tests/test_utils.py::TestParseNumber::test_parse_scientific_disabled PASSED                                    [ 77%]
tests/test_utils.py::TestParseNumber::test_parse_currency_symbols PASSED                                       [ 77%]
tests/test_utils.py::TestParseNumber::test_parse_negative_numbers PASSED                                       [ 77%]
tests/test_utils.py::TestParseNumber::test_parse_positive_sign PASSED                                          [ 77%]
tests/test_utils.py::TestParseNumber::test_parse_multiple_signs PASSED                                         [ 77%]
tests/test_utils.py::TestParseNumber::test_parse_empty_string PASSED                                           [ 77%]
tests/test_utils.py::TestParseNumber::test_parse_non_numeric_text PASSED                                       [ 78%]
tests/test_utils.py::TestParseNumber::test_parse_very_small_number PASSED                                      [ 78%]
tests/test_utils.py::TestParseNumber::test_parse_very_large_number PASSED                                      [ 78%]
tests/test_utils.py::TestParseNumber::test_parse_zero_variations PASSED                                        [ 78%]
tests/test_utils.py::TestParseNumber::test_parse_strict_mode_raises_exception PASSED                           [ 78%]
tests/test_utils.py::TestParseNumber::test_parse_strict_mode_valid_input PASSED                                [ 79%]
tests/test_utils.py::TestParseNumber::test_parse_debug_mode PASSED                                             [ 79%]
tests/test_utils.py::TestParseNumber::test_parse_only_decimal_separator PASSED                                 [ 79%]
tests/test_utils.py::TestParseNumber::test_parse_multiple_decimal_separators PASSED                            [ 79%]
tests/test_utils.py::TestParseNumber::test_parse_whitespace_only PASSED                                        [ 79%]
tests/test_utils.py::TestCleanApuCode::test_clean_simple_code PASSED                                           [ 79%]
tests/test_utils.py::TestCleanApuCode::test_clean_with_spaces PASSED                                           [ 80%]
tests/test_utils.py::TestCleanApuCode::test_clean_special_characters PASSED                                    [ 80%]
tests/test_utils.py::TestCleanApuCode::test_clean_preserve_dots_hyphens PASSED                                 [ 80%]
tests/test_utils.py::TestCleanApuCode::test_clean_remove_trailing_separators PASSED                            [ 80%]
tests/test_utils.py::TestCleanApuCode::test_clean_uppercase_conversion PASSED                                  [ 80%]
tests/test_utils.py::TestCleanApuCode::test_clean_empty_raises_error_with_validation PASSED                    [ 81%]
tests/test_utils.py::TestCleanApuCode::test_clean_too_short_raises_error PASSED                                [ 81%]
tests/test_utils.py::TestCleanApuCode::test_clean_without_validation PASSED                                    [ 81%]
tests/test_utils.py::TestCleanApuCode::test_clean_numeric_conversion PASSED                                    [ 81%]
tests/test_utils.py::TestCleanApuCode::test_clean_cache_functionality PASSED                                   [ 81%]
tests/test_utils.py::TestNormalizeUnit::test_normalize_standard_unit PASSED                                    [ 81%]
tests/test_utils.py::TestNormalizeUnit::test_normalize_mapped_unit PASSED                                      [ 82%]
tests/test_utils.py::TestNormalizeUnit::test_normalize_case_insensitive PASSED                                 [ 82%]
tests/test_utils.py::TestNormalizeUnit::test_normalize_with_spaces PASSED                                      [ 82%]
tests/test_utils.py::TestNormalizeUnit::test_normalize_empty_returns_default PASSED                            [ 82%]
tests/test_utils.py::TestNormalizeUnit::test_normalize_none_returns_default PASSED                             [ 82%]
tests/test_utils.py::TestNormalizeUnit::test_normalize_unknown_unit PASSED                                     [ 83%]
tests/test_utils.py::TestNormalizeUnit::test_normalize_special_chars_removal PASSED                            [ 83%]
tests/test_utils.py::TestNormalizeUnit::test_normalize_cache_hit PASSED                                        [ 83%]
tests/test_utils.py::TestSafeReadDataframe::test_read_csv_basic PASSED                                         [ 83%]
tests/test_utils.py::TestSafeReadDataframe::test_read_csv_with_encoding_auto PASSED                            [ 83%]
tests/test_utils.py::TestSafeReadDataframe::test_read_csv_with_nrows PASSED                                    [ 84%]
tests/test_utils.py::TestSafeReadDataframe::test_read_csv_with_usecols PASSED                                  [ 84%]
tests/test_utils.py::TestSafeReadDataframe::test_read_nonexistent_file PASSED                                  [ 84%]
tests/test_utils.py::TestSafeReadDataframe::test_read_unsupported_format PASSED                                [ 84%]
tests/test_utils.py::TestSafeReadDataframe::test_read_path_object PASSED                                       [ 84%]
tests/test_utils.py::TestSafeReadDataframe::test_read_string_path PASSED                                       [ 84%]
tests/test_utils.py::TestSafeReadDataframe::test_read_csv_separator_detection PASSED                           [ 85%]
tests/test_utils.py::TestValidateNumericValue::test_validate_valid_number PASSED                               [ 85%]
tests/test_utils.py::TestValidateNumericValue::test_validate_zero_allowed PASSED                               [ 85%]
tests/test_utils.py::TestValidateNumericValue::test_validate_zero_not_allowed PASSED                           [ 85%]
tests/test_utils.py::TestValidateNumericValue::test_validate_negative_allowed PASSED                           [ 85%]
tests/test_utils.py::TestValidateNumericValue::test_validate_negative_not_allowed PASSED                       [ 86%]
tests/test_utils.py::TestValidateNumericValue::test_validate_min_value PASSED                                  [ 86%]
tests/test_utils.py::TestValidateNumericValue::test_validate_max_value PASSED                                  [ 86%]
tests/test_utils.py::TestValidateNumericValue::test_validate_range PASSED                                      [ 86%]
tests/test_utils.py::TestValidateNumericValue::test_validate_nan PASSED                                        [ 86%]
tests/test_utils.py::TestValidateNumericValue::test_validate_inf_not_allowed PASSED                            [ 86%]
tests/test_utils.py::TestValidateNumericValue::test_validate_inf_allowed PASSED                                [ 87%]
tests/test_utils.py::TestValidateNumericValue::test_validate_non_numeric_type PASSED                           [ 87%]
tests/test_utils.py::TestValidateNumericValue::test_validate_numpy_types PASSED                                [ 87%]
tests/test_utils.py::TestValidateNumericValue::test_validate_field_name_in_message PASSED                      [ 87%]
tests/test_utils.py::TestValidateSeries::test_validate_series_mask_mode PASSED                                 [ 87%]
tests/test_utils.py::TestValidateSeries::test_validate_series_dataframe_mode PASSED                            [ 88%]
tests/test_utils.py::TestValidateSeries::test_validate_empty_series PASSED                                     [ 88%]
tests/test_utils.py::TestValidateSeries::test_validate_series_with_kwargs PASSED                               [ 88%]
tests/test_utils.py::TestCreateApuSignature::test_signature_basic PASSED                                       [ 88%]
tests/test_utils.py::TestCreateApuSignature::test_signature_custom_fields PASSED                               [ 88%]
tests/test_utils.py::TestCreateApuSignature::test_signature_missing_fields PASSED                              [ 88%]
tests/test_utils.py::TestCreateApuSignature::test_signature_empty_data PASSED                                  [ 89%]
tests/test_utils.py::TestCreateApuSignature::test_signature_numeric_values PASSED                              [ 89%]
tests/test_utils.py::TestCreateApuSignature::test_signature_normalization PASSED                               [ 89%]
tests/test_utils.py::TestDetectOutliers::test_detect_outliers_iqr_basic PASSED                                 [ 89%]
tests/test_utils.py::TestDetectOutliers::test_detect_outliers_with_bounds PASSED                               [ 89%]
tests/test_utils.py::TestDetectOutliers::test_detect_outliers_zscore PASSED                                    [ 90%]
tests/test_utils.py::TestDetectOutliers::test_detect_outliers_modified_zscore PASSED                           [ 90%]
tests/test_utils.py::TestDetectOutliers::test_detect_outliers_empty_series PASSED                              [ 90%]
tests/test_utils.py::TestDetectOutliers::test_detect_outliers_all_nan PASSED                                   [ 90%]
tests/test_utils.py::TestDetectOutliers::test_detect_outliers_invalid_method PASSED                            [ 90%]
tests/test_utils.py::TestDetectOutliers::test_detect_outliers_constant_series PASSED                           [ 90%]
tests/test_utils.py::TestDetectOutliers::test_detect_outliers_custom_threshold PASSED                          [ 91%]
tests/test_utils.py::TestFindAndRenameColumns::test_rename_exact_match PASSED                                  [ 91%]
tests/test_utils.py::TestFindAndRenameColumns::test_rename_partial_match PASSED                                [ 91%]
tests/test_utils.py::TestFindAndRenameColumns::test_rename_case_insensitive PASSED                             [ 91%]
tests/test_utils.py::TestFindAndRenameColumns::test_rename_case_sensitive PASSED                               [ 91%]
tests/test_utils.py::TestFindAndRenameColumns::test_rename_multiple_possibilities PASSED                       [ 92%]
tests/test_utils.py::TestFindAndRenameColumns::test_rename_empty_dataframe PASSED                              [ 92%]
tests/test_utils.py::TestFindAndRenameColumns::test_rename_no_matches PASSED                                   [ 92%]
tests/test_utils.py::TestBatchProcessDataframe::test_batch_process_small_df PASSED                             [ 92%]
tests/test_utils.py::TestBatchProcessDataframe::test_batch_process_large_df PASSED                             [ 92%]
tests/test_utils.py::TestBatchProcessDataframe::test_batch_process_with_kwargs PASSED                          [ 93%]
tests/test_utils.py::TestSanitizeForJson::test_sanitize_basic_types PASSED                                     [ 93%]
tests/test_utils.py::TestSanitizeForJson::test_sanitize_numpy_types PASSED                                     [ 93%]
tests/test_utils.py::TestSanitizeForJson::test_sanitize_pandas_types PASSED                                    [ 93%]
tests/test_utils.py::TestSanitizeForJson::test_sanitize_nan_inf PASSED                                         [ 93%]
tests/test_utils.py::TestSanitizeForJson::test_sanitize_pandas_na PASSED                                       [ 93%]
tests/test_utils.py::TestSanitizeForJson::test_sanitize_nested_structures PASSED                               [ 94%]
tests/test_utils.py::TestSanitizeForJson::test_sanitize_max_depth_error PASSED                                 [ 94%]
tests/test_utils.py::TestSanitizeForJson::test_sanitize_datetime PASSED                                        [ 94%]
tests/test_utils.py::TestCalculateStatistics::test_statistics_basic PASSED                                     [ 94%]
tests/test_utils.py::TestCalculateStatistics::test_statistics_with_nulls PASSED                                [ 94%]
tests/test_utils.py::TestCalculateStatistics::test_statistics_empty_series PASSED                              [ 95%]
tests/test_utils.py::TestCalculateStatistics::test_statistics_all_nan PASSED                                   [ 95%]
tests/test_utils.py::TestCalculateStatistics::test_statistics_quartiles PASSED                                 [ 95%]
tests/test_utils.py::TestCalculateStdDev::test_std_dev_basic PASSED                                            [ 95%]
tests/test_utils.py::TestCalculateStdDev::test_std_dev_constant_values PASSED                                  [ 95%]
tests/test_utils.py::TestCalculateStdDev::test_std_dev_single_value PASSED                                     [ 95%]
tests/test_utils.py::TestCalculateStdDev::test_std_dev_empty_list PASSED                                       [ 96%]
tests/test_utils.py::TestCalculateUnitCosts::test_calculate_costs_basic PASSED                                 [ 96%]
tests/test_utils.py::TestCalculateUnitCosts::test_calculate_costs_empty_df PASSED                              [ 96%]
tests/test_utils.py::TestCalculateUnitCosts::test_calculate_costs_missing_columns PASSED                       [ 96%]
tests/test_utils.py::TestCalculateUnitCosts::test_calculate_costs_aggregation PASSED                           [ 96%]
tests/test_utils.py::TestCalculateUnitCosts::test_calculate_costs_percentages PASSED                           [ 97%]
tests/test_utils.py::TestCalculateUnitCosts::test_calculate_costs_zero_division PASSED                         [ 97%]
tests/test_utils.py::TestIntegration::test_full_workflow_text_processing PASSED                                [ 97%]
tests/test_utils.py::TestIntegration::test_full_workflow_numeric_processing PASSED                             [ 97%]
tests/test_utils.py::TestIntegration::test_full_workflow_dataframe_processing PASSED                           [ 97%]
tests/test_utils.py::TestIntegration::test_full_workflow_apu_processing PASSED                                 [ 97%]
tests/test_utils.py::TestPerformance::test_normalize_text_cache_performance PASSED                             [ 98%]
tests/test_utils.py::TestPerformance::test_parse_number_performance PASSED                                     [ 98%]
tests/test_utils.py::TestPerformance::test_batch_processing_efficiency PASSED                                  [ 98%]
tests/test_utils.py::TestConstants::test_standard_units_is_frozen_set PASSED                                   [ 98%]
tests/test_utils.py::TestConstants::test_standard_units_contains_common_units PASSED                           [ 98%]
tests/test_utils.py::TestConstants::test_unit_mapping_is_dict PASSED                                           [ 99%]
tests/test_utils.py::TestConstants::test_unit_mapping_consistency PASSED                                       [ 99%]
tests/test_utils.py::TestErrorHandling::test_normalize_text_invalid_type_handling PASSED                       [ 99%]
tests/test_utils.py::TestErrorHandling::test_parse_number_extreme_values PASSED                                [ 99%]
tests/test_utils.py::TestErrorHandling::test_validate_numeric_mixed_types PASSED                               [ 99%]
tests/test_utils.py::TestErrorHandling::test_safe_read_corrupted_file PASSED                                   [100%]

================================================== warnings summary ==================================================
tests/test_app.py: 55 warnings
tests/test_estimator.py: 6 warnings
  /home/gerardo/miniconda3/envs/ap_filter_env/lib/python3.10/site-packages/flask_session/base.py:172: DeprecationWarning: The 'use_signer' option is deprecated and will be removed in the next minor release. Please update your configuration accordingly or open an issue.
    warnings.warn(

tests/test_app.py::TestCreateApp::test_create_app_development
tests/test_app.py::TestCreateApp::test_create_app_testing
tests/test_app.py::TestCreateApp::test_create_app_production
tests/test_app.py::TestCreateApp::test_create_app_config_loading
tests/test_app.py::TestCreateApp::test_create_app_upload_folder_creation
tests/test_app.py::TestCreateApp::test_create_app_session_configuration
  /home/gerardo/miniconda3/envs/ap_filter_env/lib/python3.10/site-packages/flask_session/redis/redis.py:51: RuntimeWarning: No valid Redis instance provided, attempting to create a new instance on localhost with default settings.
    warnings.warn(

tests/test_apu_processor.py::TestAPUProcessor::test_integration_with_calculate_unit_costs
tests/test_apu_processor.py::TestAPUProcessor::test_process_all
  /home/gerardo/Documentos/GitHub/apu_filter/app/schemas.py:520: UserWarning: ManoDeObra [1.1]: unidades 'M3'/'UNIDAD' no son tpicas. Unidades esperadas: frozenset({'JOR', 'DIA', 'MES', 'SEMANA', 'HORA'})
    self._validate_consistency()

tests/test_apu_processor.py::TestAPUProcessor::test_integration_with_calculate_unit_costs
tests/test_apu_processor.py::TestAPUProcessor::test_process_all
  /home/gerardo/Documentos/GitHub/apu_filter/app/apu_processor.py:567: UserWarning: Suministro [1.1]: rendimiento=350.0 no es relevante. Se recomienda usar 0.0
    return InsumoClass(

tests/test_apu_processor.py::TestAPUProcessor::test_integration_with_calculate_unit_costs
tests/test_apu_processor.py::TestAPUProcessor::test_process_all
  /home/gerardo/Documentos/GitHub/apu_filter/app/schemas.py:520: UserWarning: ManoDeObra [2.1]: unidades 'M3'/'UNIDAD' no son tpicas. Unidades esperadas: frozenset({'JOR', 'DIA', 'MES', 'SEMANA', 'HORA'})
    self._validate_consistency()

tests/test_schemas.py::TestInsumoProcesado::test_create_valid_insumo
tests/test_schemas.py::TestInsumoProcesado::test_normalization_in_post_init
tests/test_schemas.py::TestInsumoProcesado::test_description_normalization
tests/test_schemas.py::TestInsumoProcesado::test_tipo_categoria_sync
tests/test_schemas.py::TestInsumoProcesado::test_to_dict
tests/test_schemas.py::TestInsumoProcesado::test_validate_method
tests/test_schemas.py::TestInsumoProcesado::test_repr
  /home/gerardo/Documentos/GitHub/apu_filter/app/schemas.py:520: UserWarning: InsumoProcesado [APU-001]: unidades 'M3'/'KG' no son tpicas. Unidades esperadas: frozenset({'UND', 'JUEGO', 'UNIDAD', 'PAR', 'U', 'KIT'})
    self._validate_consistency()

tests/test_schemas.py::TestManoDeObra::test_create_valid_mano_obra
  /home/gerardo/Documentos/GitHub/apu_filter/tests/test_schemas.py:738: UserWarning: ManoDeObra [APU-001]: rendimiento=0.6700 sugiere cantidad1.4925, pero cantidad=1.5000
    mano_obra = ManoDeObra(**sample_mano_obra_data)

tests/test_schemas.py::TestManoDeObra::test_jornal_validation
  /home/gerardo/Documentos/GitHub/apu_filter/tests/test_schemas.py:787: UserWarning: ManoDeObra [APU-001]: rendimiento=0.6700 sugiere cantidad1.4925, pero cantidad=1.5000
    mano_obra = ManoDeObra(**data)

tests/test_schemas.py::TestCreateInsumo::test_create_mano_obra
  /home/gerardo/Documentos/GitHub/apu_filter/app/schemas.py:939: UserWarning: ManoDeObra [APU-001]: rendimiento=0.6700 sugiere cantidad1.4925, pero cantidad=1.5000
    return insumo_class(**valid_kwargs)

tests/test_schemas.py::TestIntegration::test_workflow_all_types
  /home/gerardo/Documentos/GitHub/apu_filter/app/schemas.py:520: UserWarning: Transporte [APU-001]: unidades 'M3'/'KG' no son tpicas. Unidades esperadas: frozenset({'KM', 'VIAJE', 'MILLA', 'VIAJES', 'TON-KM'})
    self._validate_consistency()

tests/test_utils.py::TestBatchProcessDataframe::test_batch_process_large_df
tests/test_utils.py::TestBatchProcessDataframe::test_batch_process_large_df
tests/test_utils.py::TestBatchProcessDataframe::test_batch_process_large_df
tests/test_utils.py::TestBatchProcessDataframe::test_batch_process_large_df
tests/test_utils.py::TestBatchProcessDataframe::test_batch_process_large_df
  /home/gerardo/Documentos/GitHub/apu_filter/tests/test_utils.py:998: SettingWithCopyWarning: 
  A value is trying to be set on a copy of a slice from a DataFrame.
  Try using .loc[row_indexer,col_indexer] = value instead
  
  See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
    df_chunk['B'] = df_chunk['A'] * 2

tests/test_utils.py::TestBatchProcessDataframe::test_batch_process_with_kwargs
tests/test_utils.py::TestBatchProcessDataframe::test_batch_process_with_kwargs
  /home/gerardo/Documentos/GitHub/apu_filter/tests/test_utils.py:1011: SettingWithCopyWarning: 
  A value is trying to be set on a copy of a slice from a DataFrame.
  Try using .loc[row_indexer,col_indexer] = value instead
  
  See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
    df_chunk['B'] = df_chunk['A'] * multiplier

tests/test_utils.py::TestPerformance::test_batch_processing_efficiency
tests/test_utils.py::TestPerformance::test_batch_processing_efficiency
tests/test_utils.py::TestPerformance::test_batch_processing_efficiency
tests/test_utils.py::TestPerformance::test_batch_processing_efficiency
tests/test_utils.py::TestPerformance::test_batch_processing_efficiency
  /home/gerardo/Documentos/GitHub/apu_filter/tests/test_utils.py:1437: SettingWithCopyWarning: 
  A value is trying to be set on a copy of a slice from a DataFrame.
  Try using .loc[row_indexer,col_indexer] = value instead
  
  See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
    df['C'] = df['A'] + df['B']

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
==================================== 542 passed, 2 xfailed, 96 warnings in 43.50s ====================================