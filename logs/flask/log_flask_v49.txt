 * Serving Flask app 'app.app:create_app('development')'
 * Debug mode: off
WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on http://127.0.0.1:5002
Press CTRL+C to quit
127.0.0.1 - - [12/Oct/2025 18:56:50] "GET / HTTP/1.1" 200 -
127.0.0.1 - - [12/Oct/2025 18:56:51] "GET /favicon.ico HTTP/1.1" 404 -
127.0.0.1 - - [12/Oct/2025 18:56:52] "POST /upload HTTP/1.1" 200 -
127.0.0.1 - - [12/Oct/2025 18:56:53] "POST /api/estimate HTTP/1.1" 200 -
127.0.0.1 - - [12/Oct/2025 18:56:53] "POST /api/estimate HTTP/1.1" 200 -
[2025-10-12 18:57:00,935] ERROR in app: Excepción no controlada en get_apu_detail para el código 16,2: "Column(s) ['UNIDAD'] do not exist"
Traceback (most recent call last):
  File "/Users/gerardomayor/Documents/estru_techos/apu_filter/app/app.py", line 192, in get_apu_detail
    df_mo_agrupado = df_mano_de_obra.groupby('DESCRIPCION_INSUMO').agg(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gerardomayor/Documents/estru_techos/apu_filter/.venv/lib/python3.12/site-packages/pandas/core/groupby/generic.py", line 1432, in aggregate
    result = op.agg()
             ^^^^^^^^
  File "/Users/gerardomayor/Documents/estru_techos/apu_filter/.venv/lib/python3.12/site-packages/pandas/core/apply.py", line 190, in agg
    return self.agg_dict_like()
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/gerardomayor/Documents/estru_techos/apu_filter/.venv/lib/python3.12/site-packages/pandas/core/apply.py", line 423, in agg_dict_like
    return self.agg_or_apply_dict_like(op_name="agg")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gerardomayor/Documents/estru_techos/apu_filter/.venv/lib/python3.12/site-packages/pandas/core/apply.py", line 1603, in agg_or_apply_dict_like
    result_index, result_data = self.compute_dict_like(
                                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gerardomayor/Documents/estru_techos/apu_filter/.venv/lib/python3.12/site-packages/pandas/core/apply.py", line 462, in compute_dict_like
    func = self.normalize_dictlike_arg(op_name, selected_obj, func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/gerardomayor/Documents/estru_techos/apu_filter/.venv/lib/python3.12/site-packages/pandas/core/apply.py", line 663, in normalize_dictlike_arg
    raise KeyError(f"Column(s) {list(cols)} do not exist")
KeyError: "Column(s) ['UNIDAD'] do not exist"
127.0.0.1 - - [12/Oct/2025 18:57:00] "GET /api/apu/16,2 HTTP/1.1" 500 -