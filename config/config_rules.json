{
  "presupuesto_column_map": {
    "CODIGO_APU": ["ITEM"],
    "DESCRIPCION_APU": ["DESCRIPCION"],
    "CANTIDAD_PRESUPUESTO": ["CANT."]
  },
  "validation_thresholds": {
    "MANO_DE_OBRA": {
      "min_jornal": 50000,
      "max_jornal": 600000,
      "max_valor_total": 2000000
    },
    "EQUIPO": {
      "max_valor_total": 5000000
    },
    "DEFAULT": {
      "max_valor_total": 10000000
    }
  },
  "file_profiles": {
    "presupuesto_default": {
      "description": "Perfil para presupuesto CSV estándar.",
      "loader_params": {
        "header": 0,
        "sep": ";",
        "encoding": "UTF-8-SIG"
      }
    },
    "insumos_default": {
      "description": "Perfil para insumos jerárquicos.",
      "parser_strategy": "hierarchical_v1",
      "encoding": "UTF-8-SIG"
    },
    "apus_default": {
      "description": "Perfil para APUs semi-estructurados.",
      "parser_strategy": "state_machine_v2",
      "encoding": "utf-8",
      "number_format": {
        "decimal_separator": "comma"
      }
    }
  },
  "pipeline_recipe": [
    {"step": "load_data", "enabled": true},
    {"step": "merge_data", "enabled": true},
    {"step": "calculate_costs", "enabled": true},
    {"step": "business_topology", "enabled": true},
    {"step": "final_merge", "enabled": true},
    {"step": "build_output", "enabled": true}
  ],
  "clean_apu_code_params": {
    "presupuesto_item": {
      "min_length": 1,
      "max_length": 50,
      "replace_comma": true
    }
  },
  "apu_processor_rules": {
    "special_cases": {
      "TRANSPORTE": "TRANSPORTE",
      "SUMINISTRO": "SUMINISTRO",
      "ACARREO": "TRANSPORTE",
      "FLETE": "TRANSPORTE"
    },
    "mo_keywords": [
      "M.O.", "MANO DE OBRA", "OFICIAL", "AYUDANTE", "MAESTRO", "CUADRILLA"
    ],
    "equipo_keywords": [
      "EQUIPO", "HERRAMIENTA", "ANDAMIO", "MAQUINARIA", "HERRAMIENTA MENOR"
    ],
    "otro_keywords": [
        "IMPUESTOS", "RETENCIONES", "POLIZAS", "ADMINISTRACION", "AIU"
    ]
  },
  "estimator_thresholds": {
    "min_semantic_similarity_suministro": 0.30,
    "min_semantic_similarity_tarea": 0.40,
    "min_keyword_match_percentage_cuadrilla": 50.0
  },
  "param_map": {
    "material": {
      "TST": "CANAL - SOLO LAMINA",
      "PANEL SANDWICH": "PANEL SANDWICH"
    },
    "tipo": {
      "CUBIERTA": "INSTALACION",
      "FACHADA": "INSTALACION"
    }
  },
  "min_score_threshold": 85,
  "estimator_rules": {
    "factores_zona": {
      "ZONA 0": 1.0,
      "ZONA 1": 1.05,
      "ZONA 2": 1.10,
      "ZONA 3": 1.15
    },
    "costo_adicional_izaje": {
      "MANUAL": 0,
      "GRUA": 5000
    },
    "factor_seguridad": {
      "NORMAL": 1.0,
      "ALTA": 1.15
    }
  },
  "keyword_maps": {
    "equipo": [
      "EQUIPO", "HERRAMIENTA", "RETROEXCAVADORA", "VOLQUETA",
      "MEZCLADORA", "VIBRADOR", "COMPACTADOR", "ANDAMIO",
      "FORMALETA", "ENCOFRADO", "MAQUINARIA", "VEHICULO",
      "CAMION", "GRUA", "BOMBA", "MARTILLO", "TALADRO",
      "SIERRA", "COMPRESOR", "PLANTA", "GENERADOR"
    ],
    "mano_de_obra": [
      "M.O.", "M O ", "MANO DE OBRA", "OFICIAL", "AYUDANTE",
      "MAESTRO", "CUADRILLA", "OBRERO", "CAPATAZ", "OPERARIO",
      "SISO", "INGENIERO", "TOPOGRAFO", "RESIDENTE", "PERSONAL",
      "JORNAL", "PEON", "ALBAÑIL", "ELECTRICISTA", "PLOMERO"
    ],
    "transporte": [
      "TRANSPORTE", "ACARREO", "FLETE", "VIAJE", "MOVILIZACION",
      "CAMIONETA", "VOLQUETA", "CARGA", "DESCARGA", "TRASLADO",
      "ENVIO", "DESPACHO"
    ],
    "suministro": [
      "SUMINISTRO", "TUBO", "TUBERIA", "ACCESORIO", "VALVULA",
      "MATERIAL", "CEMENTO", "ARENA", "GRAVA", "HIERRO", "ACERO",
      "ALAMBRE", "CABLE", "LADRILLO", "BLOQUE", "MADERA",
      "PINTURA", "PEGANTE", "TORNILLO", "CLAVO", "PIEDRA",
      "AGREGADO", "CONCRETO", "MALLA", "PERNO", "VARILLA"
    ]
  },
  "apu_classification_rules": {
    "version": "2.0",
    "description": "Reglas relajadas con umbrales del 60% y categoría mixta",
    "rules": [
      {
        "type": "INSTALACION",
        "priority": 1,
        "condition": "porcentaje_mo_eq >= 60.0",
        "description": "Predomina mano de obra/equipo (≥60%)"
      },
      {
        "type": "SUMINISTRO",
        "priority": 2,
        "condition": "porcentaje_materiales >= 60.0 and porcentaje_mo_eq <= 15.0",
        "description": "Predomina material puro, poca MO (≤15%)"
      },
      {
        "type": "SUMINISTRO_PREFABRICADO",
        "priority": 3,
        "condition": "porcentaje_materiales >= 55.0 and porcentaje_mo_eq >= 15.0 and porcentaje_mo_eq < 40.0",
        "description": "Material con moderada MO para prefabricación"
      },
      {
        "type": "CONSTRUCCION_MIXTO",
        "priority": 4,
        "condition": "(porcentaje_materiales >= 40.0 and porcentaje_materiales <= 60.0) or (porcentaje_mo_eq >= 40.0 and porcentaje_mo_eq <= 60.0)",
        "description": "Balance entre materiales y MO/equipo"
      },
      {
        "type": "OBRA_COMPLETA",
        "priority": 5,
        "condition": "porcentaje_materiales > 0 and porcentaje_mo_eq > 0",
        "description": "Cualquier APU con costos válidos (fallback seguro)"
      }
    ],
    "default_type": "INDEFINIDO",
    "zero_cost_type": "SIN_COSTO"
  },
  "embedding_generation": {
    "model_name": "paraphrase-multilingual-MiniLM-L12-v2",
    "input_file": "data/processed_apus.json",
    "output_dir": "app/embeddings",
    "text_column": "original_description",
    "id_column": "CODIGO_APU",
    "max_batch_size": 512,
    "memory_limit_gb": 8.0
  }
}
